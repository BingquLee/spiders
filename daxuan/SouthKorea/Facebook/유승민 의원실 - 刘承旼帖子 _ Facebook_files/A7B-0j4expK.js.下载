if (self.CavalryLogger) { CavalryLogger.start_js(["BCwMM"]); }

__d("VideoComposerCaptionEditorSubtitlesDragArea.react",["cx","DraggableResizableText.react","React","VideoComposerDialogCaptionEditorActions","VideoComposerCaptionEditorPlayheadContainer.react","VideoComposerCaptionEditorScrubBarTimeRuler.react","immutable","VideoComposerDialogCaptionEditorConstants"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(a){__p&&__p();h.constructor.call(this,a),this.state={list:this.props.list.map(function(a,c){return{isDragging:!1,isResizingLeft:!1,isResizingRight:!1,initialLeft:0,top:b("VideoComposerDialogCaptionEditorConstants").TOP,left:this.props.list.get(c).node.left,width:this.props.list.get(c).node.width}}.bind(this))},this.onDrop=function(a){__p&&__p();var c=JSON.parse(a.dataTransfer.getData("application/json")),d=this.state.list;d=d.get(c.id);var e=a.clientX-c.x;d.isDragging=!1;if(this.checkForOverlap(c.id,d.left+e,d.width))return;d.left+=e;e=JSON.parse(JSON.stringify(this.props.list.get(c.id)));e.node.left=d.left;e.node.start_time_in_ms=d.left/b("VideoComposerDialogCaptionEditorConstants").SMALLEST_UNIT;b("VideoComposerDialogCaptionEditorActions").editingCaptionEntry(c.id,e);a.preventDefault()}.bind(this),this.updateStateDragging=function(a,c){var d=this.state.list,e=d.get(a);e.isDragging=c;e={list:d};this.setState(e);c===!1&&b("VideoComposerDialogCaptionEditorActions").playPreviewEntry(a)}.bind(this),this.updateStateResizingLeft=function(a,c,d){__p&&__p();var e=this.state.list,f=e.get(a);f.isResizingLeft=c;f.initialLeft=d;d={list:e};this.setState(d);if(c===!1){e=JSON.parse(JSON.stringify(this.props.list.get(a)));e.node.left=f.left;e.node.width=f.width;e.node.start_time_in_ms=f.left/b("VideoComposerDialogCaptionEditorConstants").SMALLEST_UNIT;e.node.duration_in_ms=f.width/b("VideoComposerDialogCaptionEditorConstants").SMALLEST_UNIT;b("VideoComposerDialogCaptionEditorActions").editingCaptionEntry(a,e);b("VideoComposerDialogCaptionEditorActions").playPreviewEntry(a)}}.bind(this),this.updateStateResizingRight=function(a,c,d){__p&&__p();var e=this.state.list,f=e.get(a);f.isResizingRight=c;f.initialLeft=d-f.width;d={list:e};this.setState(d);if(c===!1){e=JSON.parse(JSON.stringify(this.props.list.get(a)));e.node.left=f.left;e.node.width=f.width;e.node.start_time_in_ms=f.left/b("VideoComposerDialogCaptionEditorConstants").SMALLEST_UNIT;e.node.duration_in_ms=f.width/b("VideoComposerDialogCaptionEditorConstants").SMALLEST_UNIT;b("VideoComposerDialogCaptionEditorActions").editingCaptionEntry(a,e);b("VideoComposerDialogCaptionEditorActions").playPreviewEntry(a)}}.bind(this),this.funcResizingLeft=function(a,b,c){c=this.state.list;var d=c.get(a),e=d.initialLeft-b,f=d.left-e;if(this.checkForOverlap(a,f,d.width))return;d.width+=e;d.initialLeft=b;d.left=f;a={list:c};this.setState(a)}.bind(this),this.funcResizingRight=function(a,b,c){c=this.state.list;var d=c.get(a);b=b-(d.initialLeft+d.width);if(this.checkForOverlap(a,d.left,d.width+b))return;d.width+=b;a={list:c};this.setState(a)}.bind(this)}a.prototype.UNSAFE_componentWillReceiveProps=function(a){__p&&__p();if(this.props!=a){var c=JSON.stringify(this.props.list),d=JSON.stringify(a.list);({list:b("immutable").List()});if(c!==d){if(this.state.list.size!==0&&a.list.size===this.state.list.size){c=this.state.list;c=c.set(a.captionSelected,{isDragging:!1,isResizingLeft:!1,isResizingRight:!1,initialLeft:0,top:b("VideoComposerDialogCaptionEditorConstants").TOP,left:a.list.get(a.captionSelected).node.left,width:a.list.get(a.captionSelected).node.width,height:25});d={list:c}}else d={list:a.list.map(function(a,c){return{isDragging:!1,isResizingLeft:!1,isResizingRight:!1,initialLeft:0,top:b("VideoComposerDialogCaptionEditorConstants").TOP,left:a.node.left,width:a.node.width,height:25}})};this.setState(d)}}};a.prototype.shouldComponentUpdate=function(a,b){return this.props!=a||this.state!=b};a.prototype.checkForOverlap=function(a,b,c){var d=this.state.list,e=!1,f=!1;a>0&&(e=d.get(a-1).left+d.get(a-1).width>b);a+1<d.size&&(f=d.get(a+1).left<c+b);return e||f};a.prototype.onDragOver=function(a){a.dataTransfer.dropEffect="move";a.preventDefault();return!1};a.prototype.render=function(){var a=[],c=b("VideoComposerDialogCaptionEditorConstants").SMALLEST_UNIT*this.props.duration;a=this.props.list.map(function(a,c){return b("React").createElement(b("DraggableResizableText.react"),{isSelected:c===this.props.captionSelected,ref:"node_"+c,text:a.node.text,key:c,id:c,top:this.state.list.get(c).top,left:this.state.list.get(c).left,width:this.state.list.get(c).width,isDragging:this.state.list.get(c).isDragging,isResizingLeft:this.state.list.get(c).isResizingLeft,isResizingRight:this.state.list.get(c).isResizingRight,updateStateDragging:this.updateStateDragging,updateStateResizingLeft:this.updateStateResizingLeft,updateStateResizingRight:this.updateStateResizingRight,funcResizingLeft:this.funcResizingLeft,funcResizingRight:this.funcResizingRight})}.bind(this));return b("React").createElement("div",{className:"_1coi",onDragOver:this.onDragOver,onDrop:this.onDrop},b("React").createElement(b("VideoComposerCaptionEditorScrubBarTimeRuler.react"),{duration:this.props.duration,scale:1}),b("React").createElement("div",{className:"_1coj",style:{width:c}},b("React").createElement(b("VideoComposerCaptionEditorPlayheadContainer.react"),null),a))};e.exports=a}),null);