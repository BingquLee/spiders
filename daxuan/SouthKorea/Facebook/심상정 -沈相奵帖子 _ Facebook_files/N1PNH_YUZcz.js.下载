if (self.CavalryLogger) { CavalryLogger.start_js(["AFbh8"]); }

__d("VideoComposerCaptionEditorEditItem.react",["ix","cx","fbt","DialogExpansion","Image.react","React","ReactDOM","Tooltip","VideoCaptionTimestamp.react","VideoComposerDialogCaptionEditorConstants","XUIDialog.react","XUIDialogTitle.react","XUIDialogBody.react","XUIDialogButton.react","XUIDialogFooter.react","XUIError.react","XUIText.react","fbglyph"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.state={text:this.props.captionData.node.text,lastTextEntryTimeinMS:null},this.$2=function(event){this.setState({text:event.target.value,lastTextEntryTimeinMS:Date.now()});this.props.onStartTyping();var a=setTimeout(function(){var c=Date.now();this.state.lastTextEntryTimeinMS&&c-this.state.lastTextEntryTimeinMS>=b("VideoComposerDialogCaptionEditorConstants").RESUME_PLAYBACK_AFTER&&(this.props.onStopTyping(),clearTimeout(a))}.bind(this),b("VideoComposerDialogCaptionEditorConstants").RESUME_PLAYBACK_AFTER)}.bind(this),this.$1=function(){this.state.text!==this.props.captionData.node.text&&this.props.onTextChange&&this.props.onTextChange(this.state.text)}.bind(this),this.$5=function(a){a||this.props.onHandleDialogCancel()}.bind(this),c}a.prototype.componentDidMount=function(){if(this.props.isSelected){var a=b("ReactDOM").findDOMNode(this);this.props.onScrollIntoView&&this.props.onScrollIntoView(a)}};a.prototype.componentDidUpdate=function(a){if(this.props.isSelected&&!a.isSelected){var c=b("ReactDOM").findDOMNode(this);this.props.onScrollIntoView&&this.props.onScrollIntoView(c)}!this.props.isSelected&&a.isSelected&&(this.refs.textInput&&this.refs.textInput.blur(),this.refs.timestamp&&this.refs.timestamp.blur());this.props.captionData!=a.captionData&&this.setState({text:this.props.captionData.node.text})};a.prototype.render=function(){var a="_2sdr"+(this.props.isHovered&&!this.props.isSelected?" _2sds":"")+(this.props.isSelected?"":" _2sdt")+(this.props.isSelected?" _2sdu":""),c=this.props.captionData.node,d=this.props.emptyTextWarning?i._("\u4e0d\u80fd\u7559\u7a7a"):null;return b("React").createElement("div",{className:a,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,role:"presentation"},b("React").createElement("span",{className:"_2sdv"},b("React").createElement("div",{className:"_4_9q"},b("React").createElement("span",{className:"_3o8u"},b("React").createElement(b("VideoCaptionTimestamp.react"),{durationTimeInMs:c.duration_in_ms,isSelected:this.props.isSelected,maxTime:this.props.maxTime,minTime:this.props.minTime,onTimeChange:this.props.onTimeChange,startTimeInMs:c.start_time_in_ms,ref:"timestamp"}))),b("React").createElement(b("XUIError.react"),{error:d},b("React").createElement("textarea",{className:"_2sdw",maxLength:b("VideoComposerDialogCaptionEditorConstants").SEGMENT_LENGTH,ref:"textInput",name:"caption-text",placeholder:"Type in or paste your text here...",value:this.state.text,onBlur:this.$1,onChange:this.$2}))),b("React").createElement("div",{className:"_2sdx"},this.$3(),this.$4()),this.renderLayers())};a.prototype.$3=function(){var a=b("React").createElement(b("Image.react"),{src:this.props.emptyTextWarning?g("117905"):g("125915")});return this.props.isHovered||this.props.isSelected?b("React").createElement("span",babelHelpers["extends"]({"data-tooltip-alignh":"center","data-tooltip-position":"left",onClick:this.props.onAttemptDelete},b("Tooltip").propsFor(i._("\u5220\u9664")),{role:"button",tabIndex:"0"}),a):null};a.prototype.$4=function(){return(this.props.isHovered||this.props.isSelected)&&!this.props.hideInsertButton?b("React").createElement("span",babelHelpers["extends"]({"data-tooltip-alignh":"center","data-tooltip-position":"left",role:"button",tabIndex:"0",onClick:this.props.onInsert},b("Tooltip").propsFor(i._("\u63d2\u5165\u65b0\u5b57\u5e55"))),b("React").createElement(b("Image.react"),{src:g("126616")})):null};a.prototype.renderLayers=function(){return b("React").createElement(b("XUIDialog.react"),{behaviors:{DialogExpansion:b("DialogExpansion")},layerHideOnBlur:!1,shown:this.props.showDeleteConfirmDialog,width:400,onToggle:this.$5,key:"dialog"},b("React").createElement(b("XUIDialogTitle.react"),null,i._("\u5220\u9664\u5b57\u5e55")),b("React").createElement(b("XUIDialogBody.react"),null,b("React").createElement(b("XUIText.react"),{size:"header4",display:"block"},i._("\u8fd9\u4e00\u6bb5\u5b57\u5e55\u4f1a\u4ece\u89c6\u9891\u5b57\u5e55\u4e2d\u5220\u9664\u3002\u4f60\u53ef\u4ee5\u7a0d\u540e\u6dfb\u52a0\u6216\u7f16\u8f91\u66f4\u591a\u5b57\u5e55\u7247\u6bb5\u3002"))),b("React").createElement(b("XUIDialogFooter.react"),null,b("React").createElement(b("XUIDialogButton.react"),{label:i._("\u53d6\u6d88"),use:"default",onClick:this.props.onHandleDialogCancel}),b("React").createElement(b("XUIDialogButton.react"),{label:i._("\u5220\u9664\u5b57\u5e55"),onClick:this.props.onHandleDialogConfirm,use:"confirm"})))};a.propTypes={captionData:c.object.isRequired,hideInsertButton:c.bool,isHovered:c.bool,isSelected:c.bool.isRequired,emptyTextWarning:c.bool,maxTime:c.number,minTime:c.number,quality:c.number,showDeleteConfirmDialog:c.bool.isRequired,onAttemptDelete:c.func.isRequired,onClick:c.func.isRequired,onEditingCaptionEntry:c.func.isRequired,onHandleDialogConfirm:c.func.isRequired,onHandleDialogCancel:c.func.isRequired,onInsert:c.func.isRequired,onMouseEnter:c.func,onMouseLeave:c.func,onScrollIntoView:c.func,onTextChange:c.func.isRequired,onTimeChange:c.func.isRequired,onStartTyping:c.func.isRequired,onStopTyping:c.func.isRequired};e.exports=a}),null);